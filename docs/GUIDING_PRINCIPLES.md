# 🎯 核心指导思想

**最后更新**: 2026-01-12
**状态**: ✅ 已明确（基于用户反馈）

本文档定义了项目的核心指导思想，所有开发活动必须严格遵循。

---

## 🎮 游戏定位

### 核心概念
**"吸血鬼幸存者的塔防版"**

- **核心玩法**: 建筑的Roguelike与策略搭配
- **次要玩法**: 战斗爽快感
- **游戏要素**: Roguelike + 策略 + 战斗爽快感
- **难度设计**: 可选难度（适应不同玩家）

### 项目目标
- **最终目标**: 可发布的独立游戏
- **质量要求**: 高质量代码和游戏体验
- **受众**: 喜欢Roguelike和策略游戏的玩家

---

## 💎 核心开发原则

### 原则1: 质量至上 🔴

```
修改的代码不存在bug，包括体验上的问题
```

**具体要求**：
- ✅ 功能性bug必须修复（无法点击、无法购买等）
- ✅ 体验性问题也必须修复（价格不平衡、UI不友好等）
- ✅ 不追求功能数量，追求功能质量
- ❌ 禁止"先实现再修复"的方式
- ❌ 禁止已知问题的代码提交

**黄金法则**：
> **每次提交的代码都应该是"发布级别"的质量**

---

### 原则2: 谨慎迭代 🐢

```
只改少量问题，充分测试后再继续
```

**迭代节奏**：
- ✅ 每次只改1-3个相关的小问题
- ✅ 每个问题充分测试后再继续
- ✅ 确保修改不引入新问题
- ❌ 禁止一次性改动大量代码
- ❌ 禁止未经测试的连续修改

**实例**：
```
✅ 正确：修复光标显示 → 测试 → 提交 → 修复商店购买 → 测试 → 提交
❌ 错误：修复光标+商店+战斗+UI → 一次性测试 → 提交
```

---

### 原则3: 全面质量观 🎯

```
四个方面同等重要，不分先后，最终都要解决
```

**四个核心维度**：

1. **基础交互** - 游戏能启动、能看到、能点击
2. **核心玩法** - 可以完整玩一遍游戏流程
3. **游戏体验** - 玩起来爽快、平衡性好
4. **代码质量** - 架构清晰、可维护性高

**重要说明**：
- ⚠️ 不存在"优先级"问题
- ⚠️ 所有问题最终都必须解决
- ⚠️ 先解决哪个取决于当前工作，不是重要性

**实例**：
```
场景1: 刚启动项目 → 优先基础交互（必须能运行）
场景2: 已能运行 → 优先核心玩法（必须能玩）
场景3: 已能玩 → 优先游戏体验（必须好玩）
场景4: 已好玩 → 优先代码质量（必须可维护）

但这不意味着其他方面可以忽略！
```

---

### 原则4: 问题即停 🛑

```
遇到问题时：停止并分析修复
```

**问题处理流程**：

1. **停止当前工作** - 不要继续堆叠新代码
2. **深入分析根本原因** - 不要只看表象
3. **提出完整修复方案** - 包含测试计划
4. **验证修复效果** - 确保问题彻底解决
5. **总结经验教训** - 避免类似问题再次发生

**禁止行为**：
- ❌ 发现问题后继续开发新功能
- ❌ "先这样，后面再修"的想法
- ❌ 只修表象不修根本
- ❌ 修复后不验证

**实例**：
```
发现：光标不可见
错误：调整商店价格（忽略光标问题）
正确：停止所有工作 → 分析光标问题 → 修复 → 验证 → 再继续
```

---

### 原则5: 冒烟测试强制 ✅

```
每次提交前必须通过基础测试
```

**冒烟测试清单**：
```
✅ 游戏能启动吗？
✅ 能看到画面吗？
✅ 能看到光标吗？
✅ 能点击UI吗？
✅ 核心功能能用吗？
✅ 能完成一轮完整游戏流程吗？
```

**提交标准**：
- ✅ 通过所有冒烟测试
- ✅ 手动测试了修改的功能
- ✅ 验证了没有引入新问题
- ✅ 代码有适当的注释
- ❌ 不允许"应该能用"的假设

---

## 📚 文档规范

### 文档类型和风格

**设计文档** (DESIGN_DOC.md, GAMEPLAY.md等)
- **目的**: 描述游戏设计和机制
- **风格**: 简洁清晰
- **内容**: 不涉及具体代码实现
- **受众**: 游戏策划、设计师、玩家

**开发文档** (DEV_GUIDE.md, WORKFLOW.md等)
- **目的**: 指导开发过程
- **风格**: 详细实用
- **内容**: 整体开发过程和具体开发计划
- **受众**: 开发者

**代码注释**
- **风格**: 简洁适中
- **原则**: 注释"为什么"而非"是什么"
- **要求**: 复杂逻辑必须注释，简单代码不过度注释

---

## 🔄 迭代工作流程

### 标准开发流程

```
1. 确定任务
   ↓
2. 分析需求和可能的问题
   ↓
3. 做小规模修改（1-3个相关问题）
   ↓
4. 本地测试（冒烟测试 + 功能测试）
   ↓
5. 确认无bug（功能性 + 体验性）
   ↓
6. 提交代码（附带清晰的说明）
   ↓
7. 回到步骤1（继续下一个任务）
```

**关键点**：
- 每个环节都不能跳过
- 发现问题立即停止并修复
- 不追求速度，追求质量

---

## 🎯 质量标准

### MVP（最小可玩版本）定义

```
玩家必须能完成以下完整流程：

1. 启动游戏
   ✓ 看到光标
   ✓ 看到安全屋UI
   ✓ 看到商店（右侧）
   ✓ 看到仓库（底部）

2. 在商店购买组件
   ✓ 光标可见
   ✓ 点击有反馈
   ✓ 金币扣除
   ✓ 组件进入仓库

3. 拖拽组件到网格
   ✓ 可以拖拽
   ✓ 可以放置
   ✓ 组件显示在网格上
   ✓ 邻接加成生效

4. 按Space进入战斗
   ✓ 光标切换
   ✓ 战斗开始
   ✓ 炮塔自动攻击
   ✓ 可以采集资源

5. 完成旅途回到安全屋
   ✓ 获得奖励
   ✓ 光标恢复
   ✓ 可以继续购买
```

**这就是MVP。任何一步失败，都不算完成。**

### 发布级别质量标准

**功能性要求**：
- ✅ 所有核心功能100%可用
- ✅ 没有阻断性bug
- ✅ 游戏可以正常完整游玩

**体验性要求**：
- ✅ 价格平衡合理
- ✅ 难度曲线适中
- ✅ UI清晰友好
- ✅ 反馈及时明确

**技术性要求**：
- ✅ 代码架构清晰
- ✅ 关键逻辑有注释
- ✅ 没有明显的性能问题
- ✅ 可维护性良好

---

## 💡 关键经验教训

### 从光标问题中学到的

1. **不要假设** - 即使是"光标可见"这种基础功能，也要验证
2. **用户视角优先** - 从"打开游戏第一眼看到什么"开始测试
3. **问题要彻底解决** - 不要只修表象
4. **质量不能妥协** - 宁可慢一点，也要做对

### 开发禁令

**绝对禁止**：
- ❌ 只看代码不运行
- ❌ 假设底层功能正常
- ❌ 跳过冒烟测试
- ❌ "先这样，后面再修"
- ❌ 没有完整游戏流程测试就提交
- ❌ 提交已知存在bug的代码

**必须做到**：
- ✅ 每次修改都运行测试
- ✅ 从用户视角验证
- ✅ 发现问题立即停止
- ✅ 小步快跑，充分验证
- ✅ 保持代码和文档同步

---

## 🎮 游戏设计核心

### 核心循环

```
安全屋整备
  ↓
购买/选择组件（Roguelike随机性）
  ↓
策略性摆放组件（塔防策略）
  ↓
进入战斗（自动战斗 + 爽快打击感）
  ↓
获得资源和奖励
  ↓
回到安全屋（新的组件选择）
  ↓
循环...
```

### 核心乐趣点

1. **建筑Roguelike** (优先级最高)
   - 随机组件生成
   - 每次游戏不同体验
   - 组件组合的多样性

2. **策略搭配** (优先级最高)
   - 组件摆放位置的策略性
   - 邻接加成系统
   - 资源分配决策

3. **战斗爽快感** (优先级次要但重要)
   - 打击感和视觉反馈
   - 敌人被击败的满足感
   - 炮塔自动攻击的观赏性

### 参考游戏

**主要灵感来源**：
- 《吸血鬼幸存者》- Roguelike核心循环
- 塔防游戏 - 策略摆放和自动战斗

**核心差异**：
- 组件系统的Roguelike随机性
- 网格摆放的策略性
- 邻接加成的深度

---

## 📋 使用指南

### 对于开发者

1. **开始工作前** - 重读本文档的核心原则
2. **做决策时** - 参考四大核心维度和质量标准
3. **完成功能后** - 对照冒烟测试清单和MVP标准
4. **遇到困惑时** - 回顾游戏设计核心和乐趣点

### 对于审核者

1. **审核代码时** - 检查是否遵循谨慎迭代原则
2. **测试功能时** - 使用冒烟测试清单
3. **评价质量时** - 参考发布级别质量标准
4. **给出反馈时** - 基于核心指导思想

---

## 🔄 文档维护

**更新触发条件**：
- 发现新的核心指导原则
- 游戏设计方向调整
- 重大经验教训总结
- 开发流程优化

**更新流程**：
1. 识别需要更新的内容
2. 修改本文档
3. 通知所有相关人员
4. 在后续工作中遵循新原则

---

**本文档是项目的"宪法"，所有决策以此为准！**
