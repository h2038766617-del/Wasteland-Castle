# ✅ 测试清单

**项目**: Wasteland Castle
**最后更新**: 2026-01-12
**用途**: 质量保证 - 每次提交前必须通过

---

## 🎯 使用说明

本清单是**强制性的质量门槛**，每次提交代码前必须完整执行。

### 测试层级

```
Level 1: 冒烟测试（必须100%通过）
  ↓
Level 2: MVP流程测试（必须100%通过）
  ↓
Level 3: 功能测试（针对修改的功能）
  ↓
Level 4: 回归测试（确保没有引入新问题）
```

**任何一级失败，立即停止并修复！**

---

## 🚨 Level 1: 冒烟测试

**时间**: 2分钟
**要求**: 100%通过，否则不得提交

### 基础启动测试

```
□ 游戏能正常启动吗？
  - 打开浏览器访问 http://localhost:8000
  - 看到加载界面
  - 加载界面消失，游戏开始

□ 能看到游戏画面吗？
  - Canvas正常渲染
  - 看到载具
  - 看到网格

□ 能看到鼠标光标吗？
  - 移动鼠标，光标可见
  - 光标在Canvas上方可见（SAFEHOUSE状态）

□ 能点击UI吗？
  - 鼠标可以点击商店
  - 鼠标可以点击仓库
  - 点击有反馈（console日志或UI变化）

□ Console有错误吗？
  - 打开浏览器Console
  - 没有红色错误信息
  - 警告可以忽略（黄色）
```

**如果任何一项失败，立即停止并修复！**

---

## 🎮 Level 2: MVP流程测试

**时间**: 5-10分钟
**要求**: 完整流程可玩通

### 完整游戏循环测试

#### 步骤1: 启动游戏

```
□ 游戏正常启动
□ 看到安全屋UI（半透明黑色背景）
□ 看到标题"安全屋整备"
□ 看到商店（右侧面板）
□ 看到仓库（底部）
□ 看到资源显示（金币、弹药、建材）
□ 光标可见且可移动
```

#### 步骤2: 购买组件

```
□ 商店显示3-5个商品
□ 每个商品显示：
  - 组件类型（CORE/WEAPON/ARMOR/BOOSTER）
  - 品质（common/uncommon/rare/epic）
  - HP数值
  - 价格
□ 点击商品
  - 金币扣除（资源显示更新）
  - 商品从商店消失
  - Console显示"购买成功"日志
  - 组件出现在底部仓库
```

**测试用例**：
- 购买最便宜的商品 ✓
- 购买后查看仓库 ✓
- 再购买1-2个商品 ✓

#### 步骤3: 拖拽组件

```
□ 点击仓库中的组件
  - 组件被拿起
  - 跟随鼠标移动
  - 显示半透明预览

□ 移动到网格上
  - 绿色预览（可放置位置）
  - 红色预览（不可放置位置）

□ 松开鼠标
  - 组件放置到网格
  - 组件从仓库消失
  - 网格上显示组件
  - 邻接加成计算（如有相邻组件）
```

**测试用例**：
- 放置1个CORE组件到中央 ✓
- 放置1个WEAPON组件在CORE旁边 ✓
- 观察邻接加成（应有加成效果）✓

#### 步骤4: 进入战斗

```
□ 按Space键
  - 安全屋UI消失
  - 载具开始移动
  - 游戏进入JOURNEY状态
  - 光标变为游戏内自定义光标（系统光标隐藏）

□ 战斗开始
  - 敌人从右侧出现
  - 炮塔自动攻击敌人
  - 看到子弹飞行
  - 击中敌人有伤害数字
  - 敌人血条减少
```

**测试用例**：
- 等待1-2个敌人被击败 ✓
- 观察资源掉落（红色弹药）✓
- 观察金币获得（击杀奖励）✓

#### 步骤5: 采集资源

```
□ 资源节点出现
  - 地图上出现资源节点（蓝色/红色方块）

□ 移动光标到资源上
  - 光标悬停在资源节点
  - 采集进度开始（3秒）
  - 采集完成后资源消失
  - 资源数量增加（红色或蓝色）
```

#### 步骤6: 完成旅途

**选项A - 完成第1波**：
```
□ 击败第1波所有敌人（10个）
□ 准备期开始（8秒）
□ 第2波敌人出现
□ （可选）继续战斗或按Space暂停
```

**选项B - 直接返回**：
```
□ 按R键重启游戏
□ 回到安全屋
□ 光标重新出现（系统光标）
□ 可以继续购买
```

**测试用例**：
- 完成至少1波敌人 ✓
- 或按R重启回到安全屋 ✓

---

## 🔧 Level 3: 功能测试

**时间**: 根据修改内容
**要求**: 针对性测试修改的功能

### 商店系统测试

```
□ 商店显示
  - 3-5个商品正确显示
  - 价格显示正确
  - 品质颜色正确

□ 购买功能
  - 金币充足时可以购买
  - 金币不足时无法购买（提示"金币不足"）
  - 购买后金币扣除正确
  - 购买后商品移除

□ 刷新功能
  - 点击刷新按钮
  - 消耗5金币
  - 商品重新随机生成
  - 锁定的商品保留

□ 锁定功能
  - 右键点击商品
  - 商品显示锁🔒标志
  - 刷新时锁定商品保留
  - 再次右键解锁
```

### 拖拽系统测试

```
□ 拖拽启动
  - 点击仓库组件
  - 组件被拾起
  - 游戏暂停

□ 拖拽预览
  - 跟随鼠标移动
  - 绿色=可放置
  - 红色=不可放置

□ 放置成功
  - 在有效位置松开
  - 组件放置到网格
  - 从仓库移除
  - 邻接加成计算

□ 放置失败
  - 在无效位置松开
  - 组件回到仓库
  - 无任何改变
```

### 战斗系统测试

```
□ 敌人生成
  - 按波次生成
  - 数量和HP正确
  - 从右侧出现

□ 自动攻击
  - 炮塔自动锁定敌人
  - 射击有冷却时间
  - 子弹飞向敌人
  - 击中造成伤害

□ 碰撞检测
  - 敌人接触组件造成伤害
  - 敌人接触载具边缘
  - 组件HP减少

□ 波次管理
  - 击败所有敌人后进入准备期
  - 准备期8秒倒计时
  - 下一波敌人出现
  - 难度渐进增加
```

### 资源系统测试

```
□ 资源采集
  - 资源节点生成
  - 光标悬停采集
  - 采集时间3秒
  - 采集后资源增加

□ 资源掉落
  - 敌人被击败掉落
  - 掉落飞向载具
  - 自动收集

□ 资源消耗
  - 射击消耗弹药
  - 修复消耗建材
  - 购买消耗金币
```

### 修复系统测试

```
□ 组件损伤显示
  - 受损组件HP条变红
  - HP数值显示正确

□ 单个修复
  - 点击受损组件
  - 消耗建材
  - HP恢复

□ 一键修复
  - 点击"一键修复"按钮
  - 所有受损组件修复
  - 建材扣除正确
```

---

## 🔄 Level 4: 回归测试

**时间**: 5分钟
**要求**: 确保之前的功能没有被破坏

### 已修复问题验证

```
□ 光标显示问题（已修复）
  - SAFEHOUSE状态光标可见 ✓
  - 可以点击UI ✓
  - JOURNEY状态光标切换 ✓
  - 回到SAFEHOUSE光标恢复 ✓

□ 商店购买问题（已修复）
  - 初始金币150 ✓
  - 商品价格降低（CORE 60, WEAPON 20等）✓
  - 刷新成本5金币 ✓
  - 购买反馈清晰 ✓
```

### 核心功能完整性

```
□ 完整游戏流程
  - 启动 → 购买 → 放置 → 战斗 → 回到安全屋
  - 全流程无阻塞
  - 全流程无错误

□ UI交互
  - 所有按钮可点击
  - 所有拖拽可用
  - 所有反馈正常

□ 游戏逻辑
  - 资源计算正确
  - 伤害计算正确
  - 邻接加成正确
  - 波次推进正确
```

---

## 🎯 边界情况测试

**时间**: 根据需要
**要求**: 测试极端情况

### 资源边界

```
□ 金币为0
  - 无法购买
  - 无法刷新
  - 显示"金币不足"

□ 金币刚好够
  - 可以购买
  - 购买后金币归零

□ 弹药耗尽
  - 武器无法射击
  - 需要采集资源
```

### 组件边界

```
□ 网格全满
  - 无法放置新组件
  - 预览显示红色

□ 仓库空
  - 没有组件可拖拽
  - 必须购买新组件

□ 核心被摧毁
  - 游戏结束
  - 显示游戏结束画面
```

### 战斗边界

```
□ 没有武器组件
  - 敌人无法被击败
  - 只能靠光标攻击

□ 第10波（最难）
  - 28个敌人
  - HP 140
  - 能否通过
```

---

## 📊 测试结果记录

### 每次测试完成后填写

```
测试日期: ____________________
测试人员: ____________________
代码版本: ____________________

Level 1 - 冒烟测试: [ ] 通过 [ ] 失败
Level 2 - MVP测试:  [ ] 通过 [ ] 失败
Level 3 - 功能测试: [ ] 通过 [ ] 失败 [ ] N/A
Level 4 - 回归测试: [ ] 通过 [ ] 失败

失败项目:
_______________________________________
_______________________________________
_______________________________________

备注:
_______________________________________
_______________________________________
```

---

## 🚀 快速测试（时间紧张时）

**最小测试集** - 10分钟完成

```
✅ 必测项（5分钟）:
  1. 游戏启动，光标可见
  2. 购买1个商品，进入仓库
  3. 拖拽到网格，成功放置
  4. 按Space进入战斗
  5. 击败1个敌人
  6. 按R回到安全屋

✅ 功能测试（5分钟）:
  针对本次修改的具体功能测试

如果快速测试通过 → 可以提交
但仍建议在提交后完整测试一次
```

---

## 📝 测试技巧

### 高效测试

1. **使用快捷键**
   - Space: 开始/暂停
   - R: 重启
   - D: 调试信息
   - H: 帮助

2. **观察Console**
   - 重要日志都有输出
   - 错误会显示为红色
   - 购买/拖拽有明确日志

3. **分层测试**
   - 先快速冒烟测试
   - 再详细功能测试
   - 最后回归测试

### 常见问题快速排查

**光标不可见**：
```
检查项：
□ Canvas的cursor样式
□ 游戏状态（SAFEHOUSE/JOURNEY）
□ Console有无错误
```

**购买失败**：
```
检查项：
□ 金币数量
□ 商品价格
□ Console日志
□ 点击是否在商品区域
```

**拖拽失败**：
```
检查项：
□ 是否在仓库区域点击
□ 组件是否存在
□ 放置位置是否有效
□ Console日志
```

---

## ✅ 提交检查清单

**在执行git commit之前**：

```
□ Level 1 冒烟测试通过
□ Level 2 MVP测试通过
□ Level 3 功能测试通过（如适用）
□ Level 4 回归测试通过
□ Console无红色错误
□ 代码有适当注释
□ 相关文档已更新
□ Commit message清晰

全部勾选 ✓ 后才能提交！
```

---

**测试不是负担，是质量的保证！**
